[["fe.html", "6 FE 6.1 Matching", " 6 FE 6.0.1 Data cleaning Using OpenData NYC, we pull aggregate K-8 attendance records and socio-economic variables for all 1125 public schools. Table 6.1: Sample Data Frame DBN School Name ENI % Male % Black %SWD % Poverty 1 01M015 P.S. 015 Roberto Clemente 190 0.890 0.479 0.032 0.258 2 01M019 P.S. 019 Asher Levy 257 0.679 0.556 0.062 0.350 3 01M020 P.S. 020 Anna Silver 497 0.800 0.509 0.032 0.237 Table 6.2: Outcome Differences by Treatment Treatment Mean Attendance Mean Chronic Absenteeism 0 92.23 27.55 1 93.48 19.83 Table 6.3: Covariate Differences by Treatment Treatment ENI Percent Black PercentSWD Percent Poverty Total Enrollment 0 0.77 0.287 0.22 0.812 641.898 1 0.59 0.218 0.19 0.611 457.217 6.0.2 Covariates Treatment (inclusion) is a significant predictor of absenteeism (CA), without matching. However, five covariates generally associated with higher absenteeism are predictive of both the treatment and the outcome, making them confounders. \\[ \\begin{align} ChronicAbsenteeism = \\beta_0 +\\beta_1Treatment + \\beta_2ENI+ \\beta_3PercentBlack+\\beta_4PercentSWD + \\\\ \\beta_5PercentPoverty +\\beta_6PercentPoverty+ BoroughFixedEffects + \\epsilon \\end{align} \\] Table 6.4: Chronic Absenteeism ~ Treatment + Covariates Predictor B SE t p (Intercept) 1.78 1.692 1.05 0.293 treatment -1.88 0.684 -2.75 0.006 TotalEnrollment 0.00 0.001 -3.97 0.000 ENI 43.59 3.981 10.95 0.000 PercentBlack 16.62 1.068 15.56 0.000 PercentSWD 36.88 4.501 8.19 0.000 PercentPoverty -20.36 3.960 -5.14 0.000 factor(borough)Brooklyn -3.76 0.683 -5.51 0.000 factor(borough)Manhattan -2.58 0.831 -3.10 0.002 factor(borough)Queens -2.62 0.788 -3.33 0.001 factor(borough)Staten Island 1.22 1.248 0.98 0.330 \\[ \\begin{align} Treatment = \\beta_0 +\\beta_1TotalEnrollment + \\beta_2ENI+ \\beta_3PercentBlack+\\beta_4PercentSWD + \\\\ \\beta_5PercentPoverty + BoroughFixedEffects + \\epsilon \\end{align} \\] Table 6.5: Treatment ~ Covariates Predictor B SE t p (Intercept) 1.19 0.065 18.27 0.000 TotalEnrollment 0.00 0.000 -10.35 0.000 ENI 0.08 0.174 0.44 0.663 PercentBlack -0.08 0.047 -1.79 0.074 PercentSWD -1.21 0.194 -6.27 0.000 PercentPoverty -0.68 0.172 -3.94 0.000 factor(borough)Brooklyn 0.01 0.030 0.44 0.663 factor(borough)Manhattan 0.17 0.036 4.73 0.000 factor(borough)Queens -0.11 0.034 -3.23 0.001 factor(borough)Staten Island -0.17 0.054 -3.10 0.002 6.1 Matching We match at a ratio of 3:1, control:treatment groups. The original sample has 885 Control (no inclusion) schools and 240 Treatment (inclusion) schools. The matched sample has 418 Control and 181 Treatment. All covariates cross the acceptable standardized mean difference threshold, and visual diagnostics of the covariate distributions confirm the balance improvement. 6.1.1 Assess Balance #&gt; Call #&gt; matchit(formula = treatment ~ PercentBlack + PercentSWD + PercentPoverty + #&gt; TotalEnrollment + ENI, data = merged, method = &quot;nearest&quot;, #&gt; caliper = 0.25, ratio = 3, family = binomial()) #&gt; #&gt; Balance Measures #&gt; Type Diff.Adj M.Threshold #&gt; distance Distance 0.0506 Balanced, &lt;0.1 #&gt; PercentBlack Contin. 0.0545 Balanced, &lt;0.1 #&gt; PercentSWD Contin. -0.0082 Balanced, &lt;0.1 #&gt; PercentPoverty Contin. -0.0288 Balanced, &lt;0.1 #&gt; TotalEnrollment Contin. -0.0293 Balanced, &lt;0.1 #&gt; ENI Contin. -0.0236 Balanced, &lt;0.1 #&gt; #&gt; Balance tally for mean differences #&gt; count #&gt; Balanced, &lt;0.1 6 #&gt; Not Balanced, &gt;0.1 0 #&gt; #&gt; Variable with the greatest mean difference #&gt; Variable Diff.Adj M.Threshold #&gt; PercentBlack 0.0545 Balanced, &lt;0.1 #&gt; #&gt; Sample sizes #&gt; Control Treated #&gt; All 885. 240 #&gt; Matched (ESS) 340.67 181 #&gt; Matched (Unweighted) 418. 181 #&gt; Unmatched 467. 59 6.1.2 Matched Estimates Matching yields a statistically significant treatment effect for both absenteeism and attendance, improving our confidence in the causal effect of inclusion on overall school attendance rates. \\[ \\begin{align} ChronicAbsenteeism = \\beta_0 +\\beta_1Treatment + \\epsilon \\end{align} \\] Table 6.6: Causal Effect using Matched Data Predictor B SE t p (Intercept) 13.41 1.665 8.06 0 treatment -4.12 0.873 -4.73 0 PercentBlack 19.15 1.623 11.80 0 PercentSWD 60.83 6.465 9.41 0 boroughBrooklyn -4.63 1.113 -4.16 0 boroughManhattan -5.09 1.232 -4.13 0 boroughQueens -8.45 1.203 -7.02 0 boroughStaten Island -9.68 1.917 -5.05 0 6.1.3 within borough matching #&gt; Call #&gt; matchit(formula = treatment ~ PercentSWD + PercentPoverty + TotalEnrollment + #&gt; ENI, data = bronx, method = &quot;nearest&quot;, caliper = 0.25, ratio = 2, #&gt; family = binomial()) #&gt; #&gt; Balance Measures #&gt; Type Diff.Adj M.Threshold #&gt; distance Distance 0.0041 Balanced, &lt;0.1 #&gt; PercentSWD Contin. 0.0182 Balanced, &lt;0.1 #&gt; PercentPoverty Contin. 0.1494 Not Balanced, &gt;0.1 #&gt; TotalEnrollment Contin. -0.0565 Balanced, &lt;0.1 #&gt; ENI Contin. 0.0834 Balanced, &lt;0.1 #&gt; #&gt; Balance tally for mean differences #&gt; count #&gt; Balanced, &lt;0.1 4 #&gt; Not Balanced, &gt;0.1 1 #&gt; #&gt; Variable with the greatest mean difference #&gt; Variable Diff.Adj M.Threshold #&gt; PercentPoverty 0.1494 Not Balanced, &gt;0.1 #&gt; #&gt; Sample sizes #&gt; Control Treated #&gt; All 222. 33 #&gt; Matched (ESS) 45.07 26 #&gt; Matched (Unweighted) 48. 26 #&gt; Unmatched 174. 7 Table 6.7: Causal Effect using Matched Data Predictor B SE t p (Intercept) 32.60 1.323 24.63 0.000 treatment -4.79 2.232 -2.14 0.035 #&gt; Call #&gt; matchit(formula = treatment ~ PercentBlack + PercentSWD + PercentPoverty + #&gt; TotalEnrollment + ENI, data = manhattan, method = &quot;nearest&quot;, #&gt; caliper = 0.25, ratio = 2, family = binomial()) #&gt; #&gt; Balance Measures #&gt; Type Diff.Adj M.Threshold #&gt; distance Distance 0.1703 #&gt; PercentBlack Contin. -0.0324 Balanced, &lt;0.1 #&gt; PercentSWD Contin. -0.1100 Not Balanced, &gt;0.1 #&gt; PercentPoverty Contin. -0.1515 Not Balanced, &gt;0.1 #&gt; TotalEnrollment Contin. -0.0104 Balanced, &lt;0.1 #&gt; ENI Contin. -0.1603 Not Balanced, &gt;0.1 #&gt; #&gt; Balance tally for mean differences #&gt; count #&gt; Balanced, &lt;0.1 2 #&gt; Not Balanced, &gt;0.1 3 #&gt; #&gt; Variable with the greatest mean difference #&gt; Variable Diff.Adj M.Threshold #&gt; ENI -0.1603 Not Balanced, &gt;0.1 #&gt; #&gt; Sample sizes #&gt; Control Treated #&gt; All 94. 95 #&gt; Matched (ESS) 59.14 53 #&gt; Matched (Unweighted) 64. 53 #&gt; Unmatched 30. 42 Table 6.7: Causal Effect using Matched Data Predictor B SE t p (Intercept) 28.36 1.636 17.34 0.000 treatment -6.61 2.430 -2.72 0.008 6.1.3.1 match on boroughs Two ways:multilevel logistic regression and logistic regression with fixed cluster effects can be used to estimate propensity scores. The effects of individual-level covariates vary across clusters. merged&lt;- read_csv(&quot;data/full_school_data.csv&quot;) #&gt; New names: #&gt; * `` -&gt; ...1 #&gt; Rows: 1125 Columns: 56 #&gt; ── Column specification ──────────────────────────────────────────────────────── #&gt; Delimiter: &quot;,&quot; #&gt; chr (6): DBN, School Name, school_type, class_option, borough, Year #&gt; dbl (50): ...1, Total Enrollment, Economic Need Index, % Male, % Black, % Wh... #&gt; #&gt; ℹ Use `spec()` to retrieve the full column specification for this data. #&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. #libraries library(MatchIt) ### nearest matching merged$treatment &lt;- ifelse(merged$self_contained == 1, 0 , 1) merged &lt;- merged %&gt;% rename(TotalEnrollment = `Total Enrollment`, ENI = `Economic Need Index`, PercentBlack = `% Black`, PercentWhite = `% White`, PercentSWD = `% Students with Disabilities`, PercentPoverty = `% Poverty`) %&gt;% select(treatment, `TotalEnrollment`, ENI, PercentBlack, PercentSWD, PercentPoverty, borough, `% Chronically Absent`, `% Attendance`) school_nearest &lt;- matchit(treatment ~ PercentBlack+ PercentSWD + PercentPoverty + TotalEnrollment + ENI + borough, family = binomial(), data = merged, method = &quot;nearest&quot;, caliper = 0.25, ratio = 2) library(cobalt) bal.tab(school_nearest, m.threshold = 0.1) #&gt; Call #&gt; matchit(formula = treatment ~ PercentBlack + PercentSWD + PercentPoverty + #&gt; TotalEnrollment + ENI + borough, data = merged, method = &quot;nearest&quot;, #&gt; caliper = 0.25, ratio = 2, family = binomial()) #&gt; #&gt; Balance Measures #&gt; Type Diff.Adj M.Threshold #&gt; distance Distance 0.0682 Balanced, &lt;0.1 #&gt; PercentBlack Contin. -0.0971 Balanced, &lt;0.1 #&gt; PercentSWD Contin. -0.0392 Balanced, &lt;0.1 #&gt; PercentPoverty Contin. -0.0534 Balanced, &lt;0.1 #&gt; TotalEnrollment Contin. 0.0179 Balanced, &lt;0.1 #&gt; ENI Contin. -0.0365 Balanced, &lt;0.1 #&gt; borough_Bronx Binary 0.0000 Balanced, &lt;0.1 #&gt; borough_Brooklyn Binary 0.0084 Balanced, &lt;0.1 #&gt; borough_Manhattan Binary 0.0028 Balanced, &lt;0.1 #&gt; borough_Queens Binary -0.0168 Balanced, &lt;0.1 #&gt; borough_Staten Island Binary 0.0056 Balanced, &lt;0.1 #&gt; #&gt; Balance tally for mean differences #&gt; count #&gt; Balanced, &lt;0.1 11 #&gt; Not Balanced, &gt;0.1 0 #&gt; #&gt; Variable with the greatest mean difference #&gt; Variable Diff.Adj M.Threshold #&gt; PercentBlack -0.0971 Balanced, &lt;0.1 #&gt; #&gt; Sample sizes #&gt; Control Treated #&gt; All 885. 240 #&gt; Matched (ESS) 258.4 179 #&gt; Matched (Unweighted) 289. 179 #&gt; Unmatched 596. 61 nearest_matched &lt;- match.data(school_nearest) ## estimating treatment effects lm(`% Chronically Absent` ~ treatment + borough, data = nearest_matched) %&gt;% tidy() %&gt;% kable(caption = &quot;Causal Effect using Matched Data&quot;, col.names = c(&quot;Predictor&quot;, &quot;B&quot;, &quot;SE&quot;, &quot;t&quot;, &quot;p&quot;), digits = c(0,2,3,2,3)) Table 6.8: Causal Effect using Matched Data Predictor B SE t p (Intercept) 30.96 1.324 23.39 0.000 treatment -4.49 1.156 -3.88 0.000 boroughBrooklyn -0.71 1.573 -0.45 0.653 boroughManhattan -3.19 1.694 -1.88 0.060 boroughQueens -12.41 1.821 -6.81 0.000 boroughStaten Island -11.55 4.238 -2.73 0.007 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
